<main class="app-container">
  <section class="card" aria-labelledby="despesas-list-title">
    <div class="panel--light list-panel">
      <div class="list-head">
        <div class="head-left">
          <div class="brand">
            <img src="assets/img/monkey.png" alt="logo" />
          </div>
          <h1 class="h1" id="despesas-list-title" style="color: var(--orange)">
            Despesas
          </h1>
        </div>
        <div class="head-actions">
          <button class="btn btn-light" type="button" (click)="irAtividades()">
            Voltar
          </button>
          <button class="btn" type="button" (click)="novaDespesa()">
            Nova Despesa
          </button>
        </div>
      </div>

      <div class="filters-row">
        <input
          class="input"
          type="text"
          placeholder="Buscar por nome ou descricao"
          [(ngModel)]="filtros.buscaTexto"
        />
        <input
          class="input"
          type="date"
          [(ngModel)]="filtros.dataInicial"
        />
        <input
          class="input"
          type="date"
          [(ngModel)]="filtros.dataFinal"
        />
        <button class="btn" type="button" (click)="aplicarFiltros()">Filtrar</button>
        <button class="btn btn-light" type="button" (click)="limparFiltros()">Limpar</button>
      </div>

      <p class="error" *ngIf="errorMsg">{{ errorMsg }}</p>
      <p class="ok" *ngIf="!errorMsg && infoMsg">{{ infoMsg }}</p>

      <div class="table-wrap">
        <table class="table">
          <thead>
            <tr>
              <th>Nome</th>
              <th>Data</th>
              <th>Valor</th>
              <th>Categoria</th>
              <th>Pagamento</th>
              <th>Acoes</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngIf="loading">
              <td colspan="6" class="center muted">Carregando...</td>
            </tr>
            <tr *ngFor="let item of despesas">
              <td>{{ item.nome || '-' }}</td>
              <td>{{ item.data | date:'dd/MM/yyyy' }}</td>
              <td>{{ item.valor | currency:'BRL':'symbol':'1.2-2':'pt-BR' }}</td>
              <td>{{ nomeCategoria(item.categoriaDespesaId) }}</td>
              <td>{{ nomeFormaPagamento(item.formaPagamentoId) }}</td>
              <td class="actions">
                <button class="btn btn-small" type="button" (click)="editar(item)" [disabled]="!item.id">Editar</button>
                <button class="btn btn-small btn-danger" type="button" (click)="excluir(item)" [disabled]="!item.id">Excluir</button>
              </td>
            </tr>
            <tr *ngIf="!loading && despesas.length === 0">
              <td colspan="6" class="center muted">Nenhuma despesa encontrada.</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="pagination">
        <span>Pagina {{ pageNumber }} de {{ totalPages }} ({{ totalCount }} registros)</span>
        <div class="pagination-actions">
          <button class="btn btn-small btn-light" type="button" (click)="paginaAnterior()" [disabled]="pageNumber <= 1">
            Anterior
          </button>
          <button class="btn btn-small" type="button" (click)="proximaPagina()" [disabled]="pageNumber >= totalPages">
            Proxima
          </button>
        </div>
      </div>
    </div>

    <aside class="panel--accent">
      <p class="sub">
        A listagem e o ponto central da gestao de despesas. Aqui voce filtra,
        revisa dados e segue para criar, editar ou excluir.
      </p>
    </aside>
  </section>
</main>
